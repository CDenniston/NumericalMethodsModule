

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pivoting Strategies &#8212; Numerical Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link media="all" rel="stylesheet" type="text/css" href="https://dokie.li/media/css/dokieli.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pdf_print.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom_layouts.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/extra.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script async="async" kind="dokieli" src="https://dokie.li/scripts/dokieli.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "CDenniston/NumericalMethodsModule");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ðŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notes/LinAlg/Pivoting';</script>
    <script src="../../_static/plausible_jupyterbookcoursetemplate.js"></script>
    <script src="../../_static/save_state.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="LU Factorization" href="LUFactorization.html" />
    <link rel="prev" title="Gaussian Elimination with Back Subsitution" href="GaussElimBackSub.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../about/syllabus.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Numerical Methods - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Numerical Methods - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../about/syllabus.html">
                    Numerical Methods : Physics 9610 Module
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 1 - Errors in Scientific Computing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ErrorsModule/Errors_summary.html">Numerical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ErrorsModule/Error_sources.html">Sources of Errors in Scientific Computing</a></li>

<li class="toctree-l1"><a class="reference internal" href="../ErrorsModule/TaylorExample.html">Truncation Error in Taylorâ€™s series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ErrorsModule/FinitePrecision.html">Finite Precision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ErrorsModule/RoundoffAmplification.html">Roundoff Error Amplification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ErrorsModule/BackwardForwardConditioning.html">Forward and Backwards Errors</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 2 - Root Finding in 1D</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Root1D/Root1D_summary.html">Root Finding in One Dimension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Root1D/Bisection.html">Bisection</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Root1D/FixedPoint.html">Fixed-Point Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Root1D/Newton.html">Faster Convergence and Newtonâ€™s Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Root1D/GeneralRoot.html">General Root Finding Algorithms</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 3 - Numerical Linear Algebra</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Lin_Alg_summary.html">Numerical Linear Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="GaussElimBackSub.html">Gaussian Elimination with Back Subsitution</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Pivoting Strategies</a></li>



<li class="toctree-l1"><a class="reference internal" href="LUFactorization.html">LU Factorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="SpecialMatrices.html">Special Matrices</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 4 - Interpolation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../InterpFit/InterpFit_summary.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InterpFit/LagrangeForm.html">Lagrange Form of the Interpolation Polynomial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InterpFit/BarycentricInterp.html">Barycentric Lagrange Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InterpFit/InterpErrors.html">Interpolation Errors</a></li>

<li class="toctree-l1"><a class="reference internal" href="../InterpFit/Chebyshev.html">Chebyshev Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InterpFit/Splines.html">Splines</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part 5 - Numerical Differentiation &amp; Integration</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../NDiffInt/NumDiffInt.html">Numerical Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NDiffInt/NumDiffInt_Errors.html">Errors in Numerical Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NDiffInt/Int.html">Numerical Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NDiffInt/HigherOrderInt.html">Higher Order Integration Schemes</a></li>

<li class="toctree-l1"><a class="reference internal" href="../NDiffInt/GaussianInt.html">Gaussian Integration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../extras/coding-notes-general.html">Python &amp; programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../extras/python-intro.html">Brief introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extras/python-virtual-environment.html">Python virtual environments</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../extras/Linux-basics.html">Linux Intro</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../extras/install-wsl.html">Installation of tools: WSL2/Linux etc.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extras/linux-basic-commands-2.html">Linux: Some basic &amp; useful commands</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../extras/editing-ascii.html">Other software</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../extras/vi-editor.html">The <code class="docutils literal notranslate"><span class="pre">vi</span></code> editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extras/helpful-software.html">Helpful software</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/CDenniston/NumericalMethodsModule/main?urlpath=lab/tree/notes/LinAlg/Pivoting.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notes/LinAlg/Pivoting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pivoting Strategies</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Pivoting Strategies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibration">Equilibration</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-pivoting">Complete Pivoting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-cost">Computational Cost</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pivoting-strategies">
<h1>Pivoting Strategies<a class="headerlink" href="#pivoting-strategies" title="Permalink to this heading">#</a></h1>
<p>In our quest to solve a linear system of equations, we have not made use of the ability to swap rows so far.  If we encounter a zero pivot, we can swap rows to fix the problem.  If there is no non-zero pivot, then there is no unique solution and we can exit with an appropriate error message.  This suggests adding a <em>choose pivot</em> section to the Forward Elimination routine along the lines of</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
    &amp;\text{find}\, p,\, k\leq p \leq n,\, \text{such that}\,\text{a}_{pk}\neq 0\\
    &amp;\text{if this is not possible,}\,A\,\text{is singular, so stop}\\
    &amp;E_p \leftrightarrow E_k\,\text{if}\,p\neq k\\
\end{align}
\end{split}\]</div>
<p>In reality, it is not actually a good idea to actually interchange rows as this memory swap takes some time and in later applications it will be useful to have a record of the swaps.  In python, a straightforward way to deal with this is to have a row index array that stores which row is which in the augmented matrix.  Then the row swap just consists of swapping the values in the row index and then use the row index array value in place of the row index anywhere else in the code.</p>
<p>We also havenâ€™t quite tied down the find <span class="math notranslate nohighlight">\(\text{a}_{pk}\neq 0\)</span> step.  There could easily be more than one value of <span class="math notranslate nohighlight">\(p\)</span> for which this would be the case.  Which one should we pick?  We learned in the Errors in Scientific Computing chapter that dividing by a small number can magnify roundoff errors.  Given our multipliers are of the form <span class="math notranslate nohighlight">\(\text{a}_{ik}/\text{a}_{kk}\)</span>, if <span class="math notranslate nohighlight">\(\text{a}_{kk}\)</span> is small we could be agravating roundoff errors.  This suggests selecting the largest possible pivot in column <span class="math notranslate nohighlight">\(k\)</span>.</p>
<a class="reference internal image-reference" href="../../_images/PartialPivoting.png"><img alt="../../_images/PartialPivoting.png" src="../../_images/PartialPivoting.png" style="width: 250px;" /></a>
<p>This will also ensure that our multipliers are all less than or equal to 1. This strategy is called <strong>partial pivoting</strong> and is usually the default for most routines.  We can modify our earier Forward Elimination routine to include partial pivoting as shown below, returning our row index array.  We then must modify our Back Substitution routine to use the row index array as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">ForwardElimination</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="c1"># setup our row index array</span>
    <span class="n">nrows</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># select pivot element A[k,k]</span>
        <span class="n">pivot</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">k</span><span class="p">]</span>
        <span class="n">prow</span> <span class="o">=</span> <span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">k</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pivot</span><span class="p">))</span> <span class="p">:</span>
                <span class="n">prow</span> <span class="o">=</span> <span class="n">p</span>
                <span class="n">pivot</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">prow</span> <span class="o">!=</span> <span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pivot</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Singular Matrix Encountered</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">nrows</span>
            <span class="c1"># As rows may have been swapped previously, we need to double index nrows</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">nrows</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
            <span class="n">nrows</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="o">=</span><span class="n">nrows</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">prow</span><span class="p">]]</span>
            <span class="n">nrows</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">prow</span><span class="p">]]</span><span class="o">=</span><span class="n">tmp</span>
        <span class="c1"># Now we loop over i, the rows below the pivot row</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">m</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">pivot</span>
            <span class="c1"># Loop over j, the columns of row i</span>
            <span class="c1"># The line below is equivalent to the following loop,</span>
            <span class="c1"># for j in range(k,n+1):</span>
            <span class="c1">#    A[i,j] -= m*A[k,j]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="p">:]</span> <span class="o">-=</span> <span class="n">m</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">nrows</span>

<span class="k">def</span><span class="w"> </span><span class="nf">BackSubstitution</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">nrows</span><span class="p">):</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">n</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">nrows</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">AugmentedArray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial Augmented Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">AugmentedArray</span><span class="p">)</span>
<span class="n">rowsindx</span><span class="o">=</span><span class="n">ForwardElimination</span><span class="p">(</span><span class="n">AugmentedArray</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row-reduced Augmented Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">AugmentedArray</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;row index:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">rowsindx</span><span class="p">)</span>

<span class="n">my_x</span> <span class="o">=</span> <span class="n">BackSubstitution</span><span class="p">(</span><span class="n">AugmentedArray</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">rowsindx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;solution:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">my_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial Augmented Matrix:
 [[ 1.  1.  1.  1.  3.]
 [ 1.  2.  4.  8. -2.]
 [ 1.  3.  9. 27. -5.]
 [ 1.  4. 16. 64.  0.]]
Row-reduced Augmented Matrix:
 [[  1.   1.   1.   1.   3.]
 [  0.   0.   0.   2.   2.]
 [  0.   0.  -2. -16.  -6.]
 [  0.   3.  15.  63.  -3.]]
row index:
 [0 3 2 1]
solution:
 [ 4.  3. -5.  1.]
</pre></div>
</div>
</div>
</div>
<p>We see that this gives the same solution as before, but it is evident that the path to get there was different.  Normally, but not always, partial pivoting works well.  There are other things we can try if this doesnâ€™t work.</p>
</section>
<section id="equilibration">
<h1>Equilibration<a class="headerlink" href="#equilibration" title="Permalink to this heading">#</a></h1>
<p>If the entries of our matrix <span class="math notranslate nohighlight">\(A\)</span> vary widely, then there is a possiblity that a very small number will need to be added to a very large number during Gaussian elimination, thereby enhancing roundoff errors.  This seems like a situation where scaling the rows so that the largest element (in magnitude) in each row is about the same size (might as well be 1) would help.  Does this work?</p>
<p>It turns out that if we <em>equilibrate</em> the matrix by multiplying each row by a factor so that the Euclidean norm of each row is 1, then it can be shown that the condition number <span class="math notranslate nohighlight">\(C\)</span> of the equilibrated matrix (or a linear system involving the matrix) versus original matrix satisfies</p>
<div class="math notranslate nohighlight">
\[
C(\tilde{A}) \leq C(A)
\]</div>
<p>A better conditioned problem is also less susceptible to roundoff error escalation, so this generally never hurts and can often be <em>very</em> benificial.  It is normally sufficient to just use the <span class="math notranslate nohighlight">\(\infty\)</span> norm (i.e. scale the row so that the largest element is one rather than have the Euclidian norm be one).</p>
<p>Note that this is equivalent to finding a invertible diagonal matrix <span class="math notranslate nohighlight">\(D\)</span> such that the largest element in each row of <span class="math notranslate nohighlight">\(D^{-1}A\)</span> is <span class="math notranslate nohighlight">\(1\)</span>.  Then solving <span class="math notranslate nohighlight">\(Ax=b\)</span> is found by solving <span class="math notranslate nohighlight">\(\tilde{A}x=\tilde{b}\)</span> where <span class="math notranslate nohighlight">\(\tilde{A}=D^{-1}A\)</span> and <span class="math notranslate nohighlight">\(\tilde{b}=D^{-1}b\)</span>.  In practice, we only store the diagonal in a 1D array as we know everything else is zero.</p>
<p>Adding a matrix equilibration to our previous routines is fairly straightforward and illustrated with our previous example below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">Equilibrate</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">scale</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="n">scale</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">scale</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">scale</span>

<span class="n">AugmentedArray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial Augmented Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">AugmentedArray</span><span class="p">)</span>
<span class="n">scalefactors</span><span class="o">=</span><span class="n">Equilibrate</span><span class="p">(</span><span class="n">AugmentedArray</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Equilibrated Augmented Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">AugmentedArray</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scale factors:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">scalefactors</span><span class="p">)</span>
<span class="n">rowsindx</span><span class="o">=</span><span class="n">ForwardElimination</span><span class="p">(</span><span class="n">AugmentedArray</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row-reduced Augmented Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">AugmentedArray</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;row index:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">rowsindx</span><span class="p">)</span>

<span class="n">my_x</span> <span class="o">=</span> <span class="n">BackSubstitution</span><span class="p">(</span><span class="n">AugmentedArray</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">rowsindx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;solution:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">my_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial Augmented Matrix:
 [[ 1.  1.  1.  1.  3.]
 [ 1.  2.  4.  8. -2.]
 [ 1.  3.  9. 27. -5.]
 [ 1.  4. 16. 64.  0.]]
Equilibrated Augmented Matrix:
 [[ 1.          1.          1.          1.          3.        ]
 [ 0.125       0.25        0.5         1.         -0.25      ]
 [ 0.03703704  0.11111111  0.33333333  1.         -0.18518519]
 [ 0.015625    0.0625      0.25        1.          0.        ]]
scale factors:
 [ 1.  8. 27. 64.]
Row-reduced Augmented Matrix:
 [[ 1.          1.          1.          1.          3.        ]
 [ 0.          0.125       0.375       0.875      -0.625     ]
 [ 0.          0.          0.         -0.07407407 -0.07407407]
 [ 0.          0.          0.09375     0.65625     0.1875    ]]
row index:
 [0 1 3 2]
solution:
 [ 4.  3. -5.  1.]
</pre></div>
</div>
</div>
</div>
<p>We obtain the same solution as before but the above methodology should be considerably more robust.</p>
<p>It is also possible to scale the columns to further reduce the condition number of the problem, but this is more complex so we wonâ€™t go into it here.</p>
</section>
<section id="complete-pivoting">
<h1>Complete Pivoting<a class="headerlink" href="#complete-pivoting" title="Permalink to this heading">#</a></h1>
<p>To minimize roundoff errors even further we could use a strategy called <strong>total</strong> or <strong>complete</strong> pivoting.  In this case, we switch rows <em>and</em> columns, choosing the pivot as the maximum element in the coefficient matrix in rows <span class="math notranslate nohighlight">\(k,\cdots,n\)</span> <em>and</em> columns <span class="math notranslate nohighlight">\(k,\cdots n\)</span>.</p>
<a class="reference internal image-reference" href="../../_images/TotalPivoting.png"><img alt="../../_images/TotalPivoting.png" src="../../_images/TotalPivoting.png" style="width: 250px;" /></a>
<p>This restricts the growth in all elements in the coefficient block we are working as it is possible to show that</p>
<div class="math notranslate nohighlight">
\[
|a_{ij}-m_{ik}a_{kj}|\leq 2 \max_{k\leq i,j \leq n} |a_{ij}|
\]</div>
<p>Total pivoting is an option in LAPACK routines and is only done when absolutely necessary.  Why?  This is related to the cost of doing so, but to discuss that we first need to discuss the cost for the algorithm so far.</p>
</section>
<section id="computational-cost">
<h1>Computational Cost<a class="headerlink" href="#computational-cost" title="Permalink to this heading">#</a></h1>
<p>To evaluate the cost, we count the number of <em>flops</em>, or floating point operations (one addition plus one multiplication, so computing <span class="math notranslate nohighlight">\(a+bx\)</span> is 1 flop).  Some summation formulas from first year Calculus that will be useful in this computation.  We will focus on the case where <span class="math notranslate nohighlight">\(n\)</span> is very large.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text"><strong>Summation Formulas</strong></span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="math notranslate nohighlight">
\[\begin{split}
\sum_{k=1}^n 1 = n \\
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
\sum_{k=1}^n k = \frac{n(n+1)}{2} \approx \frac{n^2}{2}
\]</div>
<div class="math notranslate nohighlight">
\[
\sum_{k=1}^n k^2= \frac{n(n+1)(2n+1)}{6} \approx \frac{n^3}{3}
\]</div>
</div>
</details><p>The work of forward elimination is mostly the repeated executions of the last line of innermost loop, where each individual operation is 1 flop.  As noted in the comment in the algorithm, that line is effectively part of a loop, and each loop further up results in a repition of this inner loop.  We just need to count each iteration of this operation, with each loop contributing a summation sign.   Which gives us</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{N}_{flops} &amp;= \sum_{k=0}^{n-2} \sum_{i=k+1}^n \sum_{j=k}^{n+1} (1) \\
&amp;\approx \sum_{k=1}^n \sum_{i=k}^n (n-k) \\
&amp;\approx \sum_{k=1}^n (n-k)^2 =\sum_{k=1}^n (n^2+k^2-2nk)\\
&amp;\approx n^3+\frac{n^3}{3}-2 n\left(\frac{n^2}{2}\right)\\
&amp;= \frac{n^3}{3}
\end{align}
\end{split}\]</div>
<p>where the approximation is for large <span class="math notranslate nohighlight">\(n\)</span>.  The number of flops for back substitution is similarly calclulated</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{N}_{flops}&amp;= \sum_{k=n-1}^1 \sum_{j=k+1}^n (1) \\
&amp;\approx \sum_{k=1}^n (n-k)\\
&amp;\approx n^2-\frac{n^2}{2} = \frac{n^2}{2}
\end{align}
\end{split}\]</div>
<p>We see that the work is dominated by the work of forward elimination (<span class="math notranslate nohighlight">\(\sim n^3\)</span> versus <span class="math notranslate nohighlight">\(\sim n^2\)</span> for back substitution).  You may wonder why we did not bother to include the cost of pivoting in the above calculations.  It is not too hard to show that the cost of partial pivoting scales like <span class="math notranslate nohighlight">\(n^2\)</span>, so is small compared to the overall cost of forward elmination for large <span class="math notranslate nohighlight">\(n\)</span>.  This assumes a comparison of two floating point operations takes a similar amount of time as 1 flop.  Total pivoting, however, scales with <span class="math notranslate nohighlight">\(n^3\)</span> so adds to the cost of forward elimination substantially, which is why it is avoided unless absolutely necessary.</p>
<p>The <span class="math notranslate nohighlight">\(n^3\)</span> factor is a very daunting increase in cost as we increase the size of the system.  For example, calculated somewhat more precisely we have</p>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(n\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(N_{flops}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3</p></td>
<td><p><span class="math notranslate nohighlight">\(\sim 170\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p><span class="math notranslate nohighlight">\(\sim 400\)</span></p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p><span class="math notranslate nohighlight">\(\sim 44000\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>100</p></td>
<td><p><span class="math notranslate nohighlight">\(\sim 340000\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>The implications are such that if it took <span class="math notranslate nohighlight">\(1\)</span> second to solve a system of size <span class="math notranslate nohighlight">\(n\)</span> it would take close to <span class="math notranslate nohighlight">\(17\)</span> minutes to solve a system <span class="math notranslate nohighlight">\(10\)</span> times larger.  As a result, we will spend some time in the next few sections examining cases where we can lower that cost.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "CDenniston/NumericalMethodsModule",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notes/LinAlg"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="GaussElimBackSub.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gaussian Elimination with Back Subsitution</p>
      </div>
    </a>
    <a class="right-next"
       href="LUFactorization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">LU Factorization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Pivoting Strategies</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#equilibration">Equilibration</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-pivoting">Complete Pivoting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-cost">Computational Cost</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Colin Denniston
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>